<?xml version="1.0" ?>

<!--
	PHING build file for releasing the 'changelog' notes of a package.

	@author Jean-Lou Dupont
	@version $Id: build.xml 253 2007-11-15 19:30:42Z JeanLou.Dupont $
-->
<project name="PackageReleaseRss" basedir="." default='rss'>

	<!--
		The package is located 1 level 'down' from the original build file.
	-->
	<target name='Config'>
		<resolvepath propertyName="project.path" file="${project.basedir}/../" /> <!-- 1 level down -->
		<property name='package.file' value='${project.path}/package.xml' />
		<echo>Package path: ${project.path}</echo>
	</target>

	<property file="./build.rss.properties" />

	<target name='rss' depends='Config'>

		<property file="./build.rss.properties" />

		<taskdef classname='JLD.PearTools.phing.DateTask' name='date' />
		<date propertyname="rss.date" />

		<!-- just in case -->
		<mkdir dir='${channel.root}/rss' />

		<echo>
			>>Creating RSS file
			>>===========================
		</echo>
		<echo file='${channel.root}/rss/{$package_name}-${package_version}.xml'><![CDATA[<?xml version="1.0"?>
<rss version="2.0">
	<!-- This file was generated by Jean-Lou Dupont's PHING task for PEAR Channel -->
	<channel>
		<title>${rss.title}</title>
		<link>${rss.link}</link>
		<description>${rss.description}</description>
		<item>
			<title>${package_version} - ${package_version}</title>
			<link>${channel.uri}</link>
			<description>Changelog:
${package.changelog}
			</description>
			<pubDate>${rss.date}</pubDate>
		</item>
	</channel>
</rss>]]></echo>
	</target>

</project>